# OpenGSLB Demo 1: Standalone Overwatch Configuration
#
# This is a simple standalone configuration with external health checks.
# No agents, no gossip, no clustering - just DNS + health checking.

mode: overwatch

# DNS Server Configuration
dns:
  listen_address: "0.0.0.0:53"
  zones:
    - demo.local
  default_ttl: 5  # Low TTL for demo visibility

# Overwatch-specific configuration
overwatch:
  identity:
    node_id: demo-overwatch
    region: demo

  # No gossip/agent configuration needed for standalone mode
  gossip:
    bind_address: ""  # Disabled - no agents in this demo

  # External validation (health checking)
  validation:
    enabled: true
    check_interval: 5s
    check_timeout: 2s

  # Stale backend handling
  stale:
    threshold: 15s
    remove_after: 60s

  # DNSSEC disabled for simplicity in demo
  dnssec:
    enabled: false

  data_dir: /var/lib/opengslb

# Region with backend servers (static configuration)
regions:
  - name: demo
    servers:
      - address: 10.10.0.21
        port: 80
        weight: 100
        service: app.demo.local  # v1.1.0: Required - domain this server belongs to
      - address: 10.10.0.22
        port: 80
        weight: 100
        service: app.demo.local
      - address: 10.10.0.23
        port: 80
        weight: 100
        service: app.demo.local
    health_check:
      type: http
      path: /health
      interval: 5s
      timeout: 2s
      failure_threshold: 2
      success_threshold: 1

# Domain routing configuration
domains:
  - name: app.demo.local
    routing_algorithm: round-robin
    regions:
      - demo
    ttl: 5  # Low TTL so DNS changes are visible quickly

# API Server
api:
  enabled: true
  address: "0.0.0.0:8080"
  allowed_networks:
    - 0.0.0.0/0  # Allow all IPv4 for demo - NOT for production!
    - "::/0"     # Allow all IPv6 for demo - NOT for production!
  trust_proxy_headers: false

# Metrics Server
metrics:
  enabled: true
  address: "0.0.0.0:9090"

# Logging
logging:
  level: info
  format: json
