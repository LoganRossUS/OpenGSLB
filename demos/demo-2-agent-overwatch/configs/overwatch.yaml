# OpenGSLB Demo 2: Overwatch Configuration
#
# This overwatch node receives gossip from agents and serves DNS.
# Agents register themselves dynamically via gossip.

mode: overwatch

# DNS Server Configuration
dns:
  listen_address: "0.0.0.0:53"
  zones:
    - demo.local
  default_ttl: 5  # Low TTL for demo visibility

# Overwatch-specific configuration
overwatch:
  identity:
    node_id: demo-overwatch
    region: demo

  # Gossip - receive health updates from agents
  gossip:
    bind_address: "0.0.0.0:7946"
    encryption_key: "cGFzc3dvcmQxMjM0NTY3ODkwMTIzNDU2Nzg5MDEyMzQ="

  # External validation as safety net
  validation:
    enabled: true
    check_interval: 5s
    check_timeout: 2s

  # Stale backend handling
  stale:
    threshold: 15s
    remove_after: 60s

  # DNSSEC disabled for simplicity in demo
  dnssec:
    enabled: false
    security_acknowledgment: "I understand that disabling DNSSEC removes cryptographic verification of DNS responses"

  data_dir: /var/lib/opengslb

# Domain routing configuration
# Backends are registered dynamically by agents via gossip
domains:
  - name: app.demo.local
    routing_algorithm: round-robin
    ttl: 5  # Low TTL so DNS changes are visible quickly

# API Server
api:
  enabled: true
  address: "0.0.0.0:8080"
  allowed_networks:
    - 0.0.0.0/0  # Allow all for demo - NOT for production!
  trust_proxy_headers: false

# Metrics Server
metrics:
  enabled: true
  address: "0.0.0.0:9090"

# Logging
logging:
  level: debug
  format: text
